{% extends 'base_templates/base.html' %}
{% load sekizai_tags %}
{% block metatitle %}in {{curr_location}}{% endblock metatitle %}
{% block main_content %}
	<h1>Clubmates</h1>
	{% if not new_location %}
	<h2>You are currently viewing listings for {{curr_location}}</h2>
	{% else %}
		<h2>We haven't visited {{curr_location}} yet!</h2>
		<h3>Would you like to add a listing?</h3>
	{% endif %}
	<div id=map></div>
    {% if venues %}
        <div id="venues">
           <h3>Venues in {{curr_location}}</h3>
           <ul>
           {% for v in venues %}
                <li><a href="/venue/{{v.id}}/" title="{{v}}">{{v}}</a></li>
           {% endfor %}
           </ul>
        </div>
    {% endif %}
	{% if children %}
		<div id="locations">
			<h3>Places in {{curr_location}}</h3>
			<ul>
			{% for c in children %}
					<li><a href="/places/{{c}}/" title="{{c}}">{{c}}</a></li>
			{% endfor %}
			</ul>
		</div>
	{% endif %}
	
	<div id="siblings" class="clear">
		{% if parent %}
			<h3>Other places in <a href="/places/{{parent}}/" title="{{parent}}">{{parent}}</a></h3>
			{% if siblings %}
			<p>{% for s in siblings %}<a href="/places/{{s}}/" title="{{s}}">{{s}}</a>{% if not forloop.last %}, {% endif %}{% endfor %}
			</p>
			{% else %}
				<p>No other places listed</p>
			{% endif %}
		{% endif %}
		<p>Add a new place to {{curr_location}} </p>
		<p>Add a listing at this location</p>
	</div>
	
{% addtoblock 'css' %}
<style>
    body {font-family: sans-serif}
    #map {width: 300px; height: 300px; float:left; margin-right:1em;}
	.clear{clear:both}
	div#locations {float:left;}
	ul {list-style:none;}
</style>
{% endaddtoblock %}

{% addtoblock 'js' %}
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script>
var map;
function initialize() {
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: {% if zoom %}{{zoom}}{% else %}15{% endif %},
        center: new google.maps.LatLng({{lat}},{{lon}}),
        mapTypeId: google.maps.MapTypeId.ROADMAP 
    });
}
</script>
{% endaddtoblock %}
	
{% endblock main_content %}